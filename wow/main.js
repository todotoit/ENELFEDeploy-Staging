!function(){function a(){function a(){}function b(a,b){var c=$(".data-label"),d=$(".data-value");TweenMax.to(c,.5,{x:"-100%",opacity:0,onComplete:function(){d.find(".value-number").text("0"),c.find(".label-title").text(a.label.title),b&&b(),TweenMax.to(c,.5,{x:"0%",opacity:1})}})}function c(a){var b=$(".data-value"),c=d3.format(",d");b.find(".value-unit").text(a.unit),d3.select(".data-value").select(".value-number").transition().duration(1500).on("start",function d(){d3.active(this).tween("text",function(){var b=d3.select(this),d=d3.interpolateNumber(b.text().replace(/,/g,""),a.value);return function(a){b.text(c(d(a)))}}).transition().delay(1500).on("start",d)})}function d(a){b(a,function(){c(a)})}var e=this;e.updateValue=c,e.update=d;a()}window.InfoLayer=a}(),function(){function a(){function a(){g.live_channel++,g.live_channel>APP.max_channels&&(g.live_channel=1)}function b(){h.open()}function c(a,b){h.send({address:a,args:b})}function d(){c("/live/"+g.live_channel+"/trans/trigger",[1])}function e(a,b){c("/live/"+g.live_channel+"/note/trigger",[10]),c("/live/"+g.live_channel+"/position/x",[a]),c("/live/"+g.live_channel+"/position/y",[b])}function f(a,b){c("/live/play/clip",[a,b])}var g=this;g.send=c,g.play=f,g.transition=d,g.send=e,g.updateLiveChannel=a,g.live_channel=0;var h=(APP.out_port,new osc.WebSocketPort({url:"ws://localhost:8080"}));b()}window.AudioController=a}(),function(){function a(){function a(){}var b=this;b.data=null;APP.BW,APP.BH;a()}window.Dataset=a}(),function(){function a(){function a(){}function b(){var a=$('<div class="graph"></div>'),b=d3.select(a.get(0)).append("svg").attr("width",g).attr("height",h).attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("viewBox","0 0 "+g+" "+h);return b}function c(a){var b=a.append("defs"),c=b.append("linearGradient").attr("id","enel-fe-gradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%");return c.append("stop").attr("class","start").attr("offset","0%").attr("stop-color","#55be5a").attr("stop-opacity",1),c.append("stop").attr("class","end").attr("offset","100%").attr("stop-color","#41b9e6").attr("stop-opacity",1),b}function d(a){var d=b();c(d),d.append("g").attr("transform","translate("+g/2+","+h/2+")").append("circle").attr("cx",function(a){return 0}).attr("cy",function(a){return 0}).attr("r",function(b){return a/2}).style("fill",function(a){return"url(#enel-fe-gradient)"});return d.node()}function e(a){var d=b(),e=(c(d),a.map(0,100,0,h));d.append("g").append("rect").attr("x",0).attr("y",g-e).attr("width",g).attr("height",e).style("fill",function(a){return"url(#enel-fe-gradient)"});return d.node()}var f=this;f.data=null,f.createCircleGraph=d,f.createFillGraph=e;var g=APP.BW,h=APP.BH;a()}window.Graph=a}(),function(){function a(){function a(){}function b(a){a instanceof jQuery&&(a=a.get(0));var b=APP.resolution,f=d(a),g=[],h=f.data,k=1/a.width,l=1/a.width;for(i=0;i<h.length;i+=4*b)if(0!==h[i]){var m={};j=i/4,quo=Math.floor(j/a.width);var m={y:quo*l,x:(j-quo*a.width)*k};_.merge(m,c(_.slice(h,i,i+3))),g.push(m)}return e.map=g,g}function c(a){var b="rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]/255+")";return{c:rgb2hex(b)}}function d(a){var b=a.getContext("2d"),c=b.getImageData(0,0,APP.BW,APP.BH);return c}var e=this;e.map=null,e.scan=b,a()}window.BufferMap=a}(),function(){function a(a){function b(){e.graphics=new PIXI.Sprite(a),e.graphics.alpha=_.random(.5,1),e.graphics.blendMode=PIXI.BLEND_MODES.NORMAL;var b=_.random(APP.min_r,APP.max_r);e.graphics.width=b,e.graphics.height=b,e.graphics.tint=5619290}function c(a,b){e.graphics.x=a,e.graphics.y=b}function d(){return{x:e.graphics.x,y:e.graphics.y}}var e=this;e.graphics=null,e.pos=c,e.getPos=d,e.tweening=!1,b()}window.Particle=a}(),function(){function a(a){function b(){if(c(),_.includes(a.graph,".svg"))$.get(a.graph,function(a){var b=a.childNodes[0];svgToCanvas(b,APP.buffer,APP.system.createPositionMap)});else{var b=null;switch(a.graph){case"circle":b=APP.graph.createCircleGraph(a.value);break;case"fill":b=APP.graph.createFillGraph(a.value);break;default:b=APP.graph.createCircleGraph(a.value)}svgToCanvas(b,APP.buffer,APP.system.createPositionMap)}}function c(){APP.audio.transition(),APP.info.update(a),APP.audio.updateLiveChannel()}function d(){g&&(clearTimeout(g),g=null)}var e=this;e.create=b,e.destroy=d;var f={id:null,label:{title:"Top label",description:"Bot label"},value:50,unit:"kWh",comparison:null,graph:"circle",live:!1},a=_.defaultsDeep(a,f),g=(APP.BW,APP.BH,null);b()}window.View=a}(),function(){function a(a){function b(b){var c=new PIXI.Graphics;c.beginFill(16777215),c.drawCircle(50,50,h),c.endFill(),c.cacheAsBitmap=!0;for(var d=c.generateCanvasTexture(),e=[],i=0;b>i;i++){var j=new Particle(d);a.addChild(j.graphics),j.pos(_.random(0,f),_.random(0,g)),e.push(j)}return e}function c(a){var b=(new BufferMap).scan(a);setTimeout(function(){d(b)},200)}function d(a,b){var c=a,d=c.length,e=d/APP.n,n=APP.g1;1>e&&(e=1);for(var o=0,p=0,q=0;p<n.length&&d>o;){var r=n[p],s=c[o],t=bufferToCanvas(s);t.x+=_.random(-i/2,i/2),t.y+=_.random(-i/2,i/2);var u=parseInt(c[o].c),v=v=_.random(.5,1);Math.random()<.5&&(v=0),Math.random()<.02&&(t={x:_.random(f),y:_.random(g)}),r.graphics.ox=t.x,r.graphics.oy=t.y,r.graphics.oc=u,r.graphics.used=!0;var w={pixi:{x:t.x,y:t.y,alpha:v,tint:u},delay:Math.random(),ease:m};b&&(w=b(w,n,c,o));var x=r.graphics.width.map(i,h,l/1.5,l);TweenMax.to(r.graphics,x,w),p++,q+=e%1,o+=Math.floor(e)+Math.floor(q),q>=1&&(q-=Math.floor(q))}var y=n.slice(p);y.forEach(function(a){var b=new Victor(a.graphics.x-f/2,a.graphics.y-g/2).normalize(),c=b.multiply(new Victor(k,k)).add(j),d=a.graphics.width.map(i,h,l/1.5,l);TweenMax.to(a.graphics,d,{x:c.x,y:c.y,delay:Math.random()})})}var e=this;e.createParticles=b,e.animateParticles=d,e.createPositionMap=c;var a=APP.stage,f=APP.W,g=APP.H,h=APP.max_r,i=APP.min_r,j=new Victor(f/2,g/2),k=1.1*j.distance(new Victor(0,0)),l=APP.transitionTime,m=APP.particleEasing}window.ParticleSystem=a}(),function(){function a(){return{enter:function(a){parseInt(a.param.dev)&&(APP.connect=!1)},leave:function(a){}}}window.MainState=a}(),function(){function a(){return{enter:function(a){d=new View(c)},leave:function(a){d.destroy()}}}function b(){APP.stateman.state(c.id,new a),APP.views.push(c.id)}var c={id:"view-den-battery",label:{title:"Energy in Paddock battery",description:""},value:54,unit:"%",comparison:!1,graph:"fill",live:!0},d=null;$(document).ready(b)}(),function(){function a(){return{enter:function(a){d=new View(c)},leave:function(a){d.destroy()}}}function b(){APP.stateman.state(c.id,new a),APP.views.push(c.id)}var c={id:"view-solar-production",label:{title:"Energy from solar panels",description:"Formula E car"},value:200,unit:"kWh",comparison:null,graph:"assets/solar.svg",live:!1},d=null;$(document).ready(b)}(),function(){function a(){return{enter:function(a){d=new View(c)},leave:function(a){d.destroy()}}}function b(){APP.stateman.state(c.id,new a),APP.views.push(c.id)}var c={id:"view-race-energy",label:{title:"Energy for the race",description:""},value:300,unit:"kWh",comparison:[11700,365],graph:"circle",live:!0},d=null;$(document).ready(b)}(),function(){function a(){return{enter:function(a){b()},leave:function(a){}}}function b(){new View(d)}function c(){APP.stateman.state(d.id,new a),APP.views.push(d.id)}var d={id:"view-icon-car",label:{title:"Energy in Formula E car",description:"Formula E car"},value:150,unit:"kWh",comparison:[11700,365],graph:"assets/fe_car.svg",live:!0};$(document).ready(c)}(),function(){function a(){return{enter:function(a){d=new View(c)},leave:function(a){d.destroy()}}}function b(){APP.stateman.state(c.id,new a),APP.views.push(c.id)}var c={id:"view-icon-battery",label:{title:"Battery capacity",description:"Formula E car"},value:200,unit:"kWh",comparison:[11700,365],graph:"assets/battery.svg",live:!0},d=null;$(document).ready(b)}(),function(a){function b(){function b(){f.render(APP.stage),requestAnimationFrame(b)}var d=a(".container");d.css({width:APP.W,height:APP.H});var f=new PIXI.autoDetectRenderer(APP.W,APP.H,null,!1,!0);f.backgroundColor=0,f.view.style.display="block",f.resize(APP.W,APP.H),a(".container").append(f.view),APP.stage=new PIXI.Container,APP.system=new ParticleSystem,APP.info=new InfoLayer,APP.dataset=new Dataset,APP.graph=new Graph,APP.interakt=window.interakt,APP.audio=new AudioController,APP.g1=APP.system.createParticles(APP.n),e(APP.n),setInterval(c,1e3*APP.changeInterval),c(),b(),window.interakt.init(APP.stage,APP),APP.connect&&(window.sok.init(APP.host,4649),window.skeleton.init(APP.stage),window.skeleton.toggleDebug()),window.keyboard.init(),d.on("mousemove",function(a){APP.interakt.addCursor(0,a.clientX,a.clientY)})}function c(){APP.stateman.go(APP.views[APP.current],{encode:!1}),APP.current++,APP.current>APP.views.length-1&&(APP.current=0)}function d(a){parseInt(a.param.dev)&&(APP.connect=!1),console.log("enter "+a.current.name)}function e(b){var c=a('<canvas id="buffer"></canvas>');APP.buffer=c.get(0),APP.buffer.width=APP.BW,APP.buffer.height=APP.BH,a("body").append(c)}window.APP={},APP.views=[],APP.W=840,APP.H=840,APP.BW=400,APP.BH=400,APP.n=5e3,APP.min_r=5,APP.max_r=16,APP.resolution=3,APP.current=0,APP.particleEasing=Elastic.easeInOut,APP.transitionTime=8,APP.changeInterval=15,APP.max_channels=2,APP.host="6.6.6.2",APP.connect=!0,APP.changeView=c,APP.initView=d,APP.stateman=new StateMan,a(document).ready(function(){a.getJSON("config.json",function(a){APP.host=a.config.host,b()})})}(window.jQuery),function(a,b,c){a(document).ready(function(){c.stateman.state({main:new MainState}).on("notfound",function(){c.stateman.go("main")}).start({html5:!1})})}(window.jQuery,window.StateMan,window.APP);