!function(){function a(){function a(){}function b(a){var b=($(".data-value"),d3.format(",d"));d3.select(".data-value").select(".value-number").transition().duration(1500).on("start",function c(){d3.active(this).tween("text",function(){var a=d3.select(this),c=d3.interpolateNumber(a.text().replace(/,/g,""),5e3);return function(d){a.text(b(c(d)))}}).transition().delay(1500).on("start",c)})}var c=this;c.updateValue=b,a()}window.InfoLayer=a}(),function(){function a(){function a(){e.open(),e.on("message",function(a){console.log("message",a)})}function b(a,b){e.send({address:a,args:b})}function c(a,c){b("/live/play/clip",[a,c])}var d=this;d.send=b,d.play=c;var e=(APP.out_port,new osc.WebSocketPort({url:"ws://localhost:8080"}));a()}window.AudioController=a}(),function(){function a(){function a(){}var b=this;b.data=null;APP.BW,APP.BH;a()}window.Dataset=a}(),function(){function a(){function a(){}function b(){var a=$('<div class="graph"></div>'),b=d3.select(a.get(0)).append("svg").attr("width",f).attr("height",g).attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("viewBox","0 0 "+f+" "+g);return b}function c(a){var b=a.append("defs"),c=b.append("linearGradient").attr("id","enel-fe-gradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%");return c.append("stop").attr("class","start").attr("offset","0%").attr("stop-color","#55be5a").attr("stop-opacity",1),c.append("stop").attr("class","end").attr("offset","100%").attr("stop-color","#41b9e6").attr("stop-opacity",1),b}function d(){var a=b();c(a),a.append("g").attr("transform","translate("+f/2+","+g/2+")").append("circle").attr("cx",function(a){return 0}).attr("cy",function(a){return 0}).attr("r",function(a){return 50}).style("fill",function(a){return"url(#enel-fe-gradient)"});svgToCanvas(a.node(),APP.buffer,APP.createPositionMap),a=null}var e=this;e.data=null,e.createChart=d;var f=APP.BW,g=APP.BH;a()}window.Graph=a}(),function(){function a(){function a(){}function b(a){a instanceof jQuery&&(a=a.get(0));var b=APP.resolution,f=d(a),g=[],h=f.data,k=1/a.width,l=1/a.width;for(i=0;i<h.length;i+=4*b)if(0!==h[i]){var m={};j=i/4,quo=Math.floor(j/a.width);var m={y:quo*l,x:(j-quo*a.width)*k};_.merge(m,c(_.slice(h,i,i+3))),g.push(m)}return e.map=g,g}function c(a){var b="rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]/255+")";return{c:rgb2hex(b)}}function d(a){var b=a.getContext("2d"),c=b.getImageData(0,0,APP.BW,APP.BH);return c}var e=this;e.map=null,e.scan=b,a()}window.BufferMap=a}(),function(){function a(a){function b(){e.graphics=new PIXI.Sprite(a),e.graphics.alpha=_.random(.5,1),e.graphics.blendMode=PIXI.BLEND_MODES.NORMAL;var b=_.random(APP.min_r,APP.max_r);e.graphics.width=b,e.graphics.height=b,e.graphics.tint=5619290}function c(a,b){e.graphics.x=a,e.graphics.y=b}function d(){return{x:e.graphics.x,y:e.graphics.y}}var e=this;e.graphics=null,e.pos=c,e.getPos=d,e.tweening=!1,b()}window.Particle=a}(),function(){function a(a){function b(b){var c=new PIXI.Graphics;c.beginFill(16777215),c.drawCircle(50,50,5),c.endFill(),c.cacheAsBitmap=!0;for(var d=c.generateCanvasTexture(),e=[],f=0;b>f;f++){var g=new Particle(d);a.addChild(g.graphics),g.pos(_.random(0,APP.W),_.random(0,APP.H)),e.push(g)}return e}function c(a){APP.interakt.pause();var b=a,c=b.length,d=c/APP.n,e=APP.g1;1>d&&(d=1);for(var f=0,g=0,h=0;g<e.length&&c>f;){var i=e[g],j=b[f],k=bufferToCanvas(j),l=b[f].c,m=m=_.random(.5,1);Math.random()<.5&&(m=0);var n=new TimelineMax({onStart:function(){i.tweening=!0},onComplete:function(){i.tweening=!1}});Math.random()<.02&&(k={x:_.random(APP.W),y:_.random(APP.H)}),n.add(TweenMax.to(i.graphics,i.graphics.width.map(APP.min_r,APP.max_r,1,1.5),{x:k.x,y:k.y,delay:Math.random(),alpha:m,colorProps:{tint:parseInt(l),format:"number"},ease:APP.particle_easing}),0),g++,h+=d%1,f+=Math.floor(d)+Math.floor(h),h>=1&&(h-=Math.floor(h))}setTimeout(APP.interakt.restore,2e3);var o=e.slice(g);o.forEach(function(a){var b=new Victor(a.graphics.x-APP.W/2,a.graphics.y-APP.H/2).normalize(),c=b.multiply(new Victor(APP.diag,APP.diag)).add(APP.center);TweenMax.to(a.graphics,1,{x:c.x,y:c.y,delay:Math.random(),onStart:function(){a.tweening=!0},onComplete:function(){a.tweening=!1}})})}var d=this;d.createParticles=b,d.animateParticles=c;var a=APP.stage;CustomEase.create("custom","M0,0,C0.24,-0.17,0.36,-0.284,0.534,-0.284,0.797,-0.284,0.964,0.788,1,1")}window.ParticleSystem=a}(),function(){function a(){return{enter:function(a){},leave:function(a){}}}window.MainState=a}(),function(a){function b(){function b(){f.render(APP.stage),requestAnimationFrame(b)}var d=a(".container");d.css({width:APP.W,height:APP.H});var f=new PIXI.autoDetectRenderer(APP.W,APP.H,null,!1,!0);f.backgroundColor=0,f.view.style.display="block",f.resize(APP.W,APP.H),a(".container").append(f.view),APP.stage=new PIXI.Container,APP.system=new ParticleSystem,APP.info=new InfoLayer,APP.dataset=new Dataset,APP.graph=new Graph,APP.interakt=window.interakt,APP.audio=new AudioController,APP.g1=APP.system.createParticles(APP.n),e(APP.n),setInterval(c,APP.changeInterval),c(),b(),window.interakt.init(APP.stage,APP),window.sok.init("10.131.184.138",4649),window.skeleton.init(APP.W,APP.H),d.on("mousemove",function(a){APP.interakt.addCursor(0,a.clientX,a.clientY)})}function c(){svgToCanvas(a(APP.views[APP.current]+" svg"),APP.buffer,d),APP.current++,APP.current>APP.views.length-1&&(APP.current=0)}function d(a){var b=(new BufferMap).scan(a);setTimeout(function(){APP.system.animateParticles(b)},500)}function e(b){var c=a('<canvas id="buffer"></canvas>');APP.buffer=c.get(0),APP.buffer.width=APP.BW,APP.buffer.height=APP.BH,a("body").append(c)}window.APP={},APP.views=["#position-map","#position-map-b","#position-map-3","#position-map-2","#position-map-4","#position-map-5"],APP.W=840,APP.H=840,APP.BW=400,APP.BH=400,APP.n=1e4,APP.min_r=5,APP.max_r=16,APP.resolution=3,APP.current=0,APP.particle_easing=Back.easeOut.config(2),APP.center=new Victor(APP.W/2,APP.H/2),APP.diag=1.1*APP.center.distance(new Victor(0,0)),APP.stateman=new StateMan,APP.createPositionMap=d,APP.changeInterval=1e4,a(document).ready(function(){b()})}(window.jQuery),function(a,b,c){a(document).ready(function(){c.stateman.state({main:new MainState}).on("notfound",function(){c.stateman.go("main")}).start({html5:!1})})}(window.jQuery,window.StateMan,window.APP);