!function(){function a(){function a(){}function b(a){var b=$(".data-label");TweenMax.to(b,.5,{x:"-100%",opacity:0,onComplete:function(){b.find(".label-title").text(a.label.title),b.find(".label-description").text(a.label.description),TweenMax.to(b,.5,{x:"0%",opacity:1})}})}function c(a){var b=$(".data-value"),c=d3.format(",d");b.find(".value-unit").text(a.unit),d3.select(".data-value").select(".value-number").transition().duration(1500).on("start",function d(){d3.active(this).tween("text",function(){var b=d3.select(this),d=d3.interpolateNumber(b.text().replace(/,/g,""),a.value);return function(a){b.text(c(d(a)))}}).transition().delay(1500).on("start",d)})}function d(a){b(a),c(a)}var e=this;e.updateValue=c,e.update=d,a()}window.InfoLayer=a}(),function(){function a(){function a(){g.open()}function b(a,b){g.send({address:a,args:b})}function c(a){b("/live/"+a+"/trans/trigger",[1])}function d(a,c){b("/live/"+APP.live_channel+"/note/trigger",[10]),b("/live/"+APP.live_channel+"/position/x",[a]),b("/live/"+APP.live_channel+"/position/y",[c])}function e(a,c){b("/live/play/clip",[a,c])}var f=this;f.send=b,f.play=e,f.transition=c,f.send=d;var g=(APP.out_port,new osc.WebSocketPort({url:"ws://localhost:8080"}));a()}window.AudioController=a}(),function(){function a(){function a(){}var b=this;b.data=null;APP.BW,APP.BH;a()}window.Dataset=a}(),function(){function a(){function a(){}function b(){var a=$('<div class="graph"></div>'),b=d3.select(a.get(0)).append("svg").attr("width",f).attr("height",g).attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("viewBox","0 0 "+f+" "+g);return b}function c(a){var b=a.append("defs"),c=b.append("linearGradient").attr("id","enel-fe-gradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%");return c.append("stop").attr("class","start").attr("offset","0%").attr("stop-color","#55be5a").attr("stop-opacity",1),c.append("stop").attr("class","end").attr("offset","100%").attr("stop-color","#41b9e6").attr("stop-opacity",1),b}function d(){var a=b();c(a),a.append("g").attr("transform","translate("+f/2+","+g/2+")").append("circle").attr("cx",function(a){return 0}).attr("cy",function(a){return 0}).attr("r",function(a){return 50}).style("fill",function(a){return"url(#enel-fe-gradient)"});svgToCanvas(a.node(),APP.buffer,APP.createPositionMap),a=null}var e=this;e.data=null,e.createChart=d;var f=APP.BW,g=APP.BH;a()}window.Graph=a}(),function(){function a(){function a(){}function b(a){a instanceof jQuery&&(a=a.get(0));var b=APP.resolution,f=d(a),g=[],h=f.data,k=1/a.width,l=1/a.width;for(i=0;i<h.length;i+=4*b)if(0!==h[i]){var m={};j=i/4,quo=Math.floor(j/a.width);var m={y:quo*l,x:(j-quo*a.width)*k};_.merge(m,c(_.slice(h,i,i+3))),g.push(m)}return e.map=g,g}function c(a){var b="rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]/255+")";return{c:rgb2hex(b)}}function d(a){var b=a.getContext("2d"),c=b.getImageData(0,0,APP.BW,APP.BH);return c}var e=this;e.map=null,e.scan=b,a()}window.BufferMap=a}(),function(){function a(a){function b(){e.graphics=new PIXI.Sprite(a),e.graphics.alpha=_.random(.5,1),e.graphics.blendMode=PIXI.BLEND_MODES.NORMAL;var b=_.random(APP.min_r,APP.max_r);e.graphics.width=b,e.graphics.height=b,e.graphics.tint=5619290}function c(a,b){e.graphics.x=a,e.graphics.y=b}function d(){return{x:e.graphics.x,y:e.graphics.y}}var e=this;e.graphics=null,e.pos=c,e.getPos=d,e.tweening=!1,b()}window.Particle=a}(),function(){function a(a){function b(b){var c=new PIXI.Graphics;c.beginFill(16777215),c.drawCircle(50,50,APP.max_r),c.endFill(),c.cacheAsBitmap=!0;for(var d=c.generateCanvasTexture(),e=[],f=0;b>f;f++){var g=new Particle(d);a.addChild(g.graphics),g.pos(_.random(0,APP.W),_.random(0,APP.H)),e.push(g)}return e}function c(a,b){var c=a,d=c.length,e=d/APP.n,f=APP.g1;1>e&&(e=1);for(var g=0,h=0,i=0;h<f.length&&d>g;){var j=f[h],k=c[g],l=bufferToCanvas(k),m=parseInt(c[g].c),n=n=_.random(.5,1);Math.random()<.5&&(n=0),Math.random()<.02&&(l={x:_.random(APP.W),y:_.random(APP.H)}),j.graphics.ox=l.x,j.graphics.oy=l.y,j.graphics.oc=m,j.graphics.used=!0;var o={pixi:{x:l.x,y:l.y,alpha:n,tint:m},delay:Math.random(),ease:APP.particle_easing};b&&(o=b(o,f,c,g)),TweenMax.to(j.graphics,j.graphics.width.map(APP.min_r,APP.max_r,APP.transitionTime/1.5,APP.transitionTime),o),h++,i+=e%1,g+=Math.floor(e)+Math.floor(i),i>=1&&(i-=Math.floor(i))}var p=f.slice(h);p.forEach(function(a){var b=new Victor(a.graphics.x-APP.W/2,a.graphics.y-APP.H/2).normalize(),c=b.multiply(new Victor(APP.diag,APP.diag)).add(APP.center);TweenMax.to(a.graphics,a.graphics.width.map(APP.min_r,APP.max_r,APP.transitionTime/1.5,APP.transitionTime),{x:c.x,y:c.y,delay:Math.random()})})}var d=this;d.createParticles=b,d.animateParticles=c;var a=APP.stage}window.ParticleSystem=a}(),function(){function a(){return{enter:function(a){parseInt(a.param.dev)&&(APP.connect=!1)},leave:function(a){}}}window.MainState=a}(),function(a){function b(){function b(){e.render(APP.stage),requestAnimationFrame(b)}var d=a(".container");d.css({width:APP.W,height:APP.H});var e=new PIXI.autoDetectRenderer(APP.W,APP.H,null,!1,!0);e.backgroundColor=0,e.view.style.display="block",e.resize(APP.W,APP.H),a(".container").append(e.view),APP.stage=new PIXI.Container,APP.system=new ParticleSystem,APP.info=new InfoLayer,APP.dataset=new Dataset,APP.graph=new Graph,APP.interakt=window.interakt,APP.audio=new AudioController,APP.g1=APP.system.createParticles(APP.n),f(APP.n),setInterval(c,1e3*APP.changeInterval),c(),b(),window.interakt.init(APP.stage,APP),APP.connect&&(window.sok.init(APP.host,4649),window.skeleton.init(APP.stage),window.skeleton.toggleDebug()),window.keyboard.init(),d.on("mousemove",function(a){APP.interakt.addCursor(0,a.clientX,a.clientY)})}function c(){svgToCanvas(a(APP.views[APP.current].graph+" svg"),APP.buffer,e),APP.audio.transition(APP.live_channel),APP.info.update(APP.views[APP.current]),APP.current++,APP.current>APP.views.length-1&&(APP.current=0),d()}function d(){APP.live_channel++,APP.live_channel>APP.max_channels&&(APP.live_channel=1)}function e(a){var b=(new BufferMap).scan(a);setTimeout(function(){APP.system.animateParticles(b)},500)}function f(b){var c=a('<canvas id="buffer"></canvas>');APP.buffer=c.get(0),APP.buffer.width=APP.BW,APP.buffer.height=APP.BH,a("body").append(c)}window.APP={},APP.W=840,APP.H=840,APP.BW=400,APP.BH=400,APP.n=5e3,APP.min_r=5,APP.max_r=16,APP.resolution=3,APP.current=0,APP.particle_easing=Elastic.easeInOut,APP.transitionTime=8,APP.center=new Victor(APP.W/2,APP.H/2),APP.diag=1.1*APP.center.distance(new Victor(0,0)),APP.stateman=new StateMan,APP.createPositionMap=e,APP.updateLiveChannel=d,APP.changeInterval=15,APP.live_channel=1,APP.max_channels=2,APP.host="6.6.6.2",APP.connect=!0,a(document).ready(function(){a.getJSON("config.json",function(c){APP.host=c.config.host,a.getJSON("data/views.json",function(a){APP.views=a.views,b()})})})}(window.jQuery),function(a,b,c){a(document).ready(function(){c.stateman.state({main:new MainState}).on("notfound",function(){c.stateman.go("main")}).start({html5:!1})})}(window.jQuery,window.StateMan,window.APP);